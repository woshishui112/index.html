<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å®¶åº­ç”¨è¯é¿å‘æŒ‡å— | æ•‘æ´ç‰ˆ Ultimate</title>
    
    <!-- === å›¾æ ‡è®¾ç½®å¼€å§‹ === -->
    <!-- 1. è¿™é‡Œçš„ href="icon.png" æ”¹æˆä½ çš„å›¾ç‰‡æ–‡ä»¶å -->
    <link rel="icon" type="image/png" href="icon.png">
    
    <!-- 2. iOS ä¸“ç”¨å›¾æ ‡ (æ·»åŠ åˆ°ä¸»å±å¹•æ—¶æ˜¾ç¤º) -->
    <link rel="apple-touch-icon" href="icon.png">
    
    <!-- 3. è®© App å…¨å±è¿è¡Œ (çœ‹èµ·æ¥æ›´åƒåŸç”Ÿ App) -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- === å›¾æ ‡è®¾ç½®ç»“æŸ === -->
    <style>
        /* --- åŸºç¡€æ ·å¼ --- */
        :root { --primary: #4f46e5; --danger: #dc2626; --warning: #d97706; --success: #10b981; --bg: #f1f5f9; --text-main: #1e293b; --text-sub: #64748b; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; background: var(--bg); color: var(--text-main); padding-bottom: 80px; }
        
        /* å¤´éƒ¨æ ·å¼ */
        header { background: linear-gradient(135deg, #4338ca 0%, #312e81 100%); color: white; padding: 16px 16px 30px 16px; position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .header-content { max-width: 800px; margin: 0 auto; display: flex; align-items: center; gap: 12px; }
        .logo-icon { background: rgba(255,255,255,0.2); padding: 6px; border-radius: 8px; display: flex; }
        
        /* æœç´¢åŒºæ ·å¼ */
        .search-section { background: white; padding: 20px; border-radius: 24px; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); margin: -20px 16px 20px 16px; position: relative; z-index: 101; max-width: 800px; left: 0; right: 0; }
        @media (min-width: 832px) { .search-section { margin: -20px auto 20px auto; } }

        .search-container { position: relative; display: flex; gap: 10px; margin-bottom: 15px; }
        input { width: 100%; padding: 14px 14px 14px 44px; font-size: 16px; border: 2px solid #e2e8f0; border-radius: 12px; outline: none; transition: all 0.3s; background: #f8fafc; color: var(--text-main); }
        input:focus { border-color: var(--primary); background: white; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
        .search-icon { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: #94a3b8; }
        
        .cam-btn { background: var(--primary); color: white; border: none; padding: 0 16px; border-radius: 12px; font-weight: bold; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; min-width: 60px; transition: 0.2s; }
        .cam-btn:active { transform: scale(0.95); background: #3730a3; }

        /* æ ‡ç­¾æŒ‰é’® */
        .tags { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
        .tags::-webkit-scrollbar { display: none; }
        .tag { white-space: nowrap; padding: 6px 14px; border-radius: 20px; border: 1px solid #cbd5e1; font-size: 13px; color: var(--text-sub); background: white; cursor: pointer; transition: 0.2s; }
        .tag.active { background: var(--primary); color: white; border-color: var(--primary); font-weight: 500; box-shadow: 0 2px 4px rgba(79, 70, 229, 0.3); }
        .tag.fav-active { background: var(--warning); border-color: var(--warning); color: white; }

        /* åˆ—è¡¨å¡ç‰‡æ ·å¼ */
        .list-container { max-width: 800px; margin: 0 auto; padding: 0 16px; }
        .card { background: white; border-radius: 16px; padding: 18px; margin-bottom: 14px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); border: 1px solid #e2e8f0; transition: all 0.2s; cursor: pointer; position: relative; }
        .card:active { transform: scale(0.99); background-color: #fafafa; }
        
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; padding-right: 20px; }
        .drug-name { font-size: 18px; font-weight: 800; color: var(--text-main); margin: 0; line-height: 1.4; display: flex; flex-wrap: wrap; align-items: center; gap: 6px; }
        
        /* ç®€ç§°æ ‡ç­¾ */
        .abbr-badge { font-size: 11px; background: #f1f5f9; color: #475569; padding: 3px 8px; border-radius: 6px; border: 1px solid #cbd5e1; font-weight: normal; display: inline-flex; align-items: center; }
        .abbr-badge b { opacity: 0.7; font-weight: bold; margin-right: 4px; font-size: 10px; color: #334155; }

        .risk-badge { font-size: 11px; font-weight: bold; padding: 4px 8px; border-radius: 6px; margin-top: 8px; display: inline-block; }
        .risk-red { background: #fef2f2; color: var(--danger); border: 1px solid #fecaca; }
        .risk-orange { background: #fff7ed; color: var(--warning); border: 1px solid #fed7aa; }
        .risk-green { background: #ecfdf5; color: var(--success); border: 1px solid #a7f3d0; }
        
        .alias { color: #94a3b8; font-size: 12px; margin-top: 6px; }
        
        /* æ”¶è—æŒ‰é’® */
        .fav-btn { position: absolute; right: 16px; top: 16px; padding: 8px; z-index: 5; color: #cbd5e1; transition: 0.2s; }
        .fav-btn.active { color: var(--warning); transform: scale(1.1); }
        
        /* è¯¦æƒ…å±•å¼€åŒº */
        .detail { display: none; margin-top: 16px; padding-top: 16px; border-top: 1px dashed #e2e8f0; animation: slideDown 0.3s ease; }
        .card.open .detail { display: block; }
        .card.open .chevron { transform: rotate(180deg); }
        .chevron { transition: 0.3s; color: #94a3b8; position: absolute; right: 16px; bottom: 16px; }
        
        .box { padding: 12px 14px; border-radius: 10px; margin-bottom: 10px; font-size: 14px; line-height: 1.6; }
        .box-harm { background: #fff1f2; border-left: 4px solid var(--danger); color: #881337; }
        .box-policy { background: #f8fafc; color: #475569; border: 1px solid #e2e8f0; font-size: 13px; }
        .box-alt { background: #f0fdf4; border: 1px solid #bbf7d0; color: #15803d; }
        
        .label { font-weight: 800; display: block; margin-bottom: 4px; font-size: 11px; text-transform: uppercase; opacity: 0.7; letter-spacing: 0.5px; }

        footer { text-align: center; color: #94a3b8; font-size: 12px; padding: 30px; }

        /* æ¨¡æ‹Ÿæ‰«æé®ç½© */
        #scan-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 200; display: none; flex-direction: column; align-items: center; justify-content: center; color: white; backdrop-filter: blur(5px); }
        .scan-frame { width: 250px; height: 250px; border: 2px solid rgba(255,255,255,0.3); border-radius: 20px; position: relative; overflow: hidden; margin-bottom: 20px; }
        .scan-line { width: 100%; height: 2px; background: #3b82f6; box-shadow: 0 0 20px #3b82f6; animation: scanning 2s infinite; position: absolute; top: 0; }
        @keyframes scanning { 0% { top: 0; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <div class="logo-icon">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
            </div>
            <div>
                <div style="font-weight:800; font-size:18px; letter-spacing:-0.5px;">å®¶åº­ç”¨è¯é¿å‘æŒ‡å—</div>
                <div style="font-size:11px; opacity:0.8; font-weight:500;">æ•‘æ´ç‰ˆ Ultimate Â· 49ç§é«˜å±è¯åº“</div>
            </div>
        </div>
    </header>

    <div class="search-section">
        <div class="search-container">
            <div style="position:relative; flex:1;">
                <span class="search-icon">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </span>
                <input type="text" id="searchInput" placeholder="æœè¯å / ç¼©å†™ / åŠŸæ•ˆ..." oninput="renderList()">
            </div>
            <button class="cam-btn" onclick="startScan()">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                AIè¯†åˆ«
            </button>
        </div>
        <div class="tags" id="categoryTags">
            <!-- JSç”Ÿæˆæ ‡ç­¾ -->
        </div>
    </div>

    <div id="drugList" class="list-container">
        <!-- JSç”Ÿæˆåˆ—è¡¨ -->
    </div>

    <footer>
        <p>âš ï¸ æœ¬å·¥å…·ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆåŒ»ç–—å»ºè®®</p>
        <p>æ•°æ®æ¥æºï¼šå›½å®¶è¯ç›‘å±€(NMPA)å…¬å‘Š / ä¸´åºŠç”¨è¯é¡»çŸ¥</p>
    </footer>

    <!-- æ¨¡æ‹Ÿæ‰«æé®ç½© -->
    <div id="scan-overlay">
        <div class="scan-frame">
            <div class="scan-line"></div>
        </div>
        <h3>æ­£åœ¨åˆ†æè¯å“åŒ…è£…...</h3>
        <p style="font-size:13px; opacity:0.7; margin-top:10px;">(æ¼”ç¤ºæ¨¡å¼ï¼šéšæœºè¯†åˆ«ä¸€ä¸ªé«˜å±è¯)</p>
    </div>

    <script>
        // --- æ ¸å¿ƒæ•°æ®åº“ (å…± 49 æ¡) ---
        const drugDatabase = [
            // === 1-29 åŸºç¡€é«˜å±è¯ ===
            { id: 1, name: "å®‰ä¹ƒè¿‘", abbr: "Analgin", aliases: ["å¤§è¯ç‰‡", "é€€çƒ§é’ˆ", "è¯ºç“¦é‡‘"], category: "é€€çƒ§æ­¢ç—›", riskLevel: "âŒ å›½å®¶æ³¨é”€ (æé«˜å±)", riskColor: "risk-red", harm: "ã€è‡´æ­»ã€‘ç²’ç»†èƒç¼ºä¹ç—‡ï¼ˆå…ç–«ç˜«ç—ªï¼‰ï¼›ä¸¥é‡è¿‡æ•æ€§ä¼‘å…‹ã€‚", consequence: "å›½å®¶è¯ç›‘å±€å…¬å‘Šï¼šåœæ­¢ç”Ÿäº§ï¼Œæ³¨é”€æ‰¹æ–‡ã€‚", alternatives: "å¸ƒæ´›èŠ¬ã€å¯¹ä¹™é…°æ°¨åŸºé…š" },
            { id: 2, name: "å°¼ç¾èˆ’åˆ©", abbr: "Nimesulide", aliases: ["ç‘èŠæ¸…", "é€€çƒ§é¢—ç²’"], category: "é€€çƒ§æ­¢ç—›", riskLevel: "âŒ 12å²ä»¥ä¸‹ç¦ç”¨", riskColor: "risk-red", harm: "ã€è‚è¡°ç«­ã€‘ä¸¥é‡è‚æ¯’æ€§ï¼Œè‡´æ­»ç‡é«˜ã€‚", consequence: "å›½å®¶é£Ÿè¯ç›‘å±€é€šçŸ¥ï¼šç¦æ­¢ç”¨äº12å²ä»¥ä¸‹ã€‚", alternatives: "å¸ƒæ´›èŠ¬ã€å¯¹ä¹™é…°æ°¨åŸºé…š" },
            { id: 3, name: "é˜¿å¸åŒ¹æ—", abbr: "Aspirin", aliases: ["å·´ç±³å°”", "ASA"], category: "é€€çƒ§æ­¢ç—›", riskLevel: "âŒ 16å²ä»¥ä¸‹å‘çƒ§ç¦ç”¨", riskColor: "risk-red", harm: "ã€ç‘æ°ç»¼åˆå¾ã€‘è‡´æ­»æ€§è„‘ç—…+è‚æŸï¼Œæ­»äº¡ç‡30%ã€‚", consequence: "å„¿ç«¥ç—…æ¯’æ„ŸæŸ“å‘çƒ§ç¦ç”¨ã€‚", alternatives: "å¸ƒæ´›èŠ¬" },
            { id: 4, name: "æ°¨åŸºæ¯”æ—", abbr: "APC", aliases: ["å»ç—›ç‰‡", "å®‰ç—›å®š"], category: "é€€çƒ§æ­¢ç—›", riskLevel: "âš ï¸ æ·˜æ±°è¯", riskColor: "risk-orange", harm: "ã€è¡€æ¶²æ¯’æ€§ã€‘ç²’ç»†èƒå‡å°‘ï¼Œä¼¤è‚¾ã€‚", consequence: "å·²è¢«æ›´å®‰å…¨è¯ç‰©æ›¿ä»£ã€‚", alternatives: "å¸ƒæ´›èŠ¬" },
            { id: 5, name: "èµ–æ°¨åŒ¹æ—", abbr: "Lys-Asp", aliases: ["é€€çƒ§é’ˆ"], category: "é€€çƒ§æ­¢ç—›", riskLevel: "âŒ 16å²ä»¥ä¸‹æ…ç”¨", riskColor: "risk-red", harm: "åŒé˜¿å¸åŒ¹æ—ï¼Œæ³¨å°„æ›´å®¹æ˜“å¼•èµ·ç‘æ°ç»¼åˆå¾ã€‚", consequence: "è¯´æ˜ä¹¦è­¦ç¤ºã€‚", alternatives: "å£æœé€€çƒ§è¯" },
            { id: 6, name: "é˜¿ç±³å¡æ˜Ÿ", abbr: "AKC", aliases: ["AMK", "ä¸èƒºå¡é‚£"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âš ï¸ å„¿ç«¥æ…ç”¨ (é«˜å±)", riskColor: "risk-orange", harm: "ã€è€³æ¯’æ€§+è‚¾æ¯’æ€§ã€‘å¬åŠ›ä¸‹é™ç”šè‡³è€³è‹ï¼›æŸä¼¤è‚¾è„ã€‚", consequence: "æ™®é€šæ„Ÿå†’ç”¨æ­¤è¯å±äºè¿‡åº¦åŒ»ç–—ã€‚", alternatives: "å¤´å­¢ç±»" },
            { id: 7, name: "åº†å¤§éœ‰ç´ ", abbr: "GM", aliases: ["Gentamycin", "é’ˆå‰‚"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âš ï¸ å„¿ç«¥æ…ç”¨ (é«˜å±)", riskColor: "risk-orange", harm: "ã€è€³æ¯’æ€§ã€‘ä¸€é’ˆè‡´è‹é£é™©ï¼Œä¸å¯é€†ã€‚", consequence: "æœªæˆå¹´äººåº”æ…ç”¨ã€‚", alternatives: "å¤´å­¢ç±»" },
            { id: 8, name: "è¯ºæ°Ÿæ²™æ˜Ÿ", abbr: "Norfloxacin", aliases: ["æ°Ÿå“Œé…¸", "æ²™æ˜Ÿ"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âŒ 18å²ç¦ç”¨", riskColor: "risk-red", harm: "ã€éª¨éª¼æŸä¼¤ã€‘å½±å“è½¯éª¨å‘è‚²ï¼Œé•¿ä¸é«˜ï¼Œè‚Œè…±æ–­è£‚ã€‚", consequence: "è¯´æ˜ä¹¦ç¦å¿Œï¼š18å²ä»¥ä¸‹ç¦ç”¨ã€‚", alternatives: "è’™è„±çŸ³æ•£" },
            { id: 9, name: "å·¦æ°§æ°Ÿæ²™æ˜Ÿ", abbr: "LVFX", aliases: ["Levofloxacin", "æ²™æ˜Ÿç±»"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âŒ 18å²ç¦ç”¨", riskColor: "risk-red", harm: "ã€éª¨éª¼æŸä¼¤ã€‘å½±å“è½¯éª¨å‘è‚²ï¼Œé•¿ä¸é«˜ã€‚", consequence: "è¯´æ˜ä¹¦ç¦å¿Œã€‚", alternatives: "å¤´å­¢ç±»" },
            { id: 10, name: "å››ç¯ç´ ", abbr: "TCY", aliases: ["åœŸéœ‰ç´ ", "OTC", "å¼ºåŠ›éœ‰ç´ "], category: "æŠ—ç”Ÿç´ ", riskLevel: "âŒ 8å²ç¦ç”¨", riskColor: "risk-red", harm: "ã€å››ç¯ç´ ç‰™ã€‘ç‰™é½¿æ°¸ä¹…å˜é»‘ã€å‘è‚²ä¸è‰¯ã€‚", consequence: "æ¯å®¹æ€§å‰¯ä½œç”¨ã€‚", alternatives: "é˜¿å¥‡éœ‰ç´ " },
            { id: 11, name: "å¯å¾…å› ", abbr: "Codeine", aliases: ["ç½‚ç²Ÿå£³", "å¼ºåŠ›æ‡æ·éœ²", "å¤æ–¹ç”˜è‰ç‰‡(æ—§)", "å…‹å’³"], category: "æ­¢å’³/æ­¢å", riskLevel: "âŒ 18å²ç¦ç”¨", riskColor: "risk-red", harm: "ã€æˆç˜¾/çª’æ¯ã€‘å«æ¯’å“æˆåˆ†ï¼ŒæŠ‘åˆ¶å‘¼å¸ã€‚", consequence: "å›½å®¶è¯ç›‘å±€å…¬å‘Šï¼š18å²ä»¥ä¸‹ç¦ç”¨ã€‚", alternatives: "å³ç¾æ²™èŠ¬" },
            { id: 12, name: "å¼‚ä¸™å—ª", abbr: "PMZ", aliases: ["éé‚£æ ¹", "Promethazine", "ä¼¤é£æ­¢å’³"], category: "æ­¢å’³/æ­¢å", riskLevel: "âŒ 2å²ç¦ç”¨", riskColor: "risk-red", harm: "ã€å‘¼å¸æŠ‘åˆ¶ã€‘å¯èƒ½å¯¼è‡´å¹¼å„¿å‘¼å¸åœæ­¢æ­»äº¡ï¼", consequence: "WHOè­¦ç¤ºï¼šç»å¯¹ç¦ç”¨äº2å²ä»¥ä¸‹ã€‚", alternatives: "æµ·ç›æ°´" },
            { id: 13, name: "è˜ç”²å”‘å•‰", abbr: "Naphazoline", aliases: ["æ»´é¼»å‡€", "æ»´é¼»æ°´"], category: "å…¶ä»–", riskLevel: "âŒ å„¿ç«¥ç¦ç”¨", riskColor: "risk-red", harm: "ã€ä¸­æ¯’ã€‘æ˜“å¯¼è‡´å„¿ç«¥ä¼‘å…‹ã€æ˜è¿·ã€‚", consequence: "ä¸´åºŠç”¨è¯é¡»çŸ¥è­¦ç¤ºã€‚", alternatives: "æµ·ç›æ°´" },
            { id: 14, name: "è‰¾ç•…(è€ç‰ˆ)", abbr: "Pseudoephedrine", aliases: ["ä¼ªéº»ç¾èŠ¬", "è‰¾ç•…"], category: "å…¶ä»–", riskLevel: "âŒ å›½å®¶æ³¨é”€", riskColor: "risk-red", harm: "å«ä¼ªéº»é»„ç¢±ï¼Œå©´å¹¼å„¿é£é™©é«˜ã€‚", consequence: "å›½å®¶è¯ç›‘å±€æ³¨é”€æ‰¹æ–‡ã€‚", alternatives: "æµ·ç›æ°´" },
            { id: 15, name: "é‡‘åˆšçƒ·èƒº", abbr: "Amantadine", aliases: ["ä¼˜å¡ä¸¹", "å¥½å¨ƒå¨ƒ", "å¿«å…‹"], category: "æŠ—ç—…æ¯’", riskLevel: "âš ï¸ 5å²æ…ç”¨", riskColor: "risk-orange", harm: "è‚è‚¾æ¯’æ€§ï¼Œå¯¹æµæ„Ÿæ— æ•ˆã€‚", consequence: "å›½å®¶è¯ç›‘å±€ä¿®è®¢è¯´æ˜ä¹¦ã€‚", alternatives: "å•ä¸€é€€çƒ§è¯" },
            { id: 16, name: "æŸ´èƒ¡æ³¨å°„æ¶²", abbr: "Chaihu", aliases: ["é€€çƒ§é’ˆ"], category: "ä¸­è¯æ³¨å°„", riskLevel: "âŒ å„¿ç«¥ç¦ç”¨", riskColor: "risk-red", harm: "ã€è¿‡æ•æ€§ä¼‘å…‹ã€‘æ›¾å¯¼è‡´å¤šèµ·å„¿ç«¥è‡´æ­»ã€‚", consequence: "å›½å®¶è¯ç›‘å±€å…¬å‘Šã€‚", alternatives: "å£æœå¸ƒæ´›èŠ¬" },
            { id: 17, name: "åŒé»„è¿æ³¨å°„æ¶²", abbr: "SHL", aliases: ["åŒé»„è¿"], category: "ä¸­è¯æ³¨å°„", riskLevel: "âŒ 4å²ç¦ç”¨", riskColor: "risk-red", harm: "ä¸¥é‡è¿‡æ•ååº”ï¼Œä¼‘å…‹ã€‚", consequence: "å›½å®¶è¯ç›‘å±€å…¬å‘Šã€‚", alternatives: "å£æœä¸­æˆè¯" },
            { id: 18, name: "èŒµæ €é»„æ³¨å°„æ¶²", abbr: "YZH", aliases: ["é€€é»„é’ˆ"], category: "ä¸­è¯æ³¨å°„", riskLevel: "âŒ æ–°ç”Ÿå„¿ç¦ç”¨", riskColor: "risk-red", harm: "ã€æ­»äº¡é£é™©ã€‘æ›¾è‡´æ–°ç”Ÿå„¿æ­»äº¡ã€‚", consequence: "å›½å®¶è¯ç›‘å±€å…¬å‘Šã€‚", alternatives: "è“å…‰ç…§å°„" },
            { id: 19, name: "å–œç‚å¹³", abbr: "XYP", aliases: ["å–œç‚å¹³"], category: "ä¸­è¯æ³¨å°„", riskLevel: "âš ï¸ æ…ç”¨", riskColor: "risk-orange", harm: "å…¨èº«æ€§è¿‡æ•ååº”ï¼Œå‘¼å¸å›°éš¾ã€‚", consequence: "ä¸è‰¯ååº”é€šæŠ¥ã€‚", alternatives: "å£æœè¯" },
            { id: 20, name: "åœŸä¸‰ä¸ƒ", abbr: "TCM Toxic", aliases: ["èŠä¸‰ä¸ƒ"], category: "ä¸­è‰è¯", riskLevel: "âŒ å‰§æ¯’", riskColor: "risk-red", harm: "ã€è‚çª¦é˜»å¡ã€‘å¯¼è‡´è‚è…¹æ°´ã€è‚è¡°ç«­ï¼Œæ— è¯å¯æ²»ã€‚", consequence: "ç»å¯¹ç¦ç”¨ã€‚", alternatives: "æ­£è§„ä¸‰ä¸ƒ" },
            { id: 21, name: "é…šé…ç‰‡", keywords: ["é…šé…", "æœå¯¼ç‰‡"], category: "å…¶ä»–", riskLevel: "âŒ å›½å®¶æ³¨é”€", riskColor: "risk-red", harm: "ã€è‡´ç™Œã€‘ä¸¥é‡è‡´ç™Œé£é™©ã€‚", consequence: "å›½å®¶è¯ç›‘å±€æ³¨é”€ã€‚", alternatives: "ä¹³æœç³–" },
            { id: 22, name: "æ´›å“Œä¸èƒº", abbr: "Loperamide", aliases: ["æ˜“è’™åœ", "æ­¢æ³»çµ"], category: "å…¶ä»–", riskLevel: "âŒ 2å²ç¦ç”¨", riskColor: "risk-red", harm: "ã€è‚ åæ­»ã€‘éº»ç—¹è‚ é“ï¼Œå¯¼è‡´æ¯’ç´ å †ç§¯ä¸­æ¯’ã€‚", consequence: "2å²ä»¥ä¸‹ç¦ç”¨ã€‚", alternatives: "è’™è„±çŸ³æ•£" },
            { id: 23, name: "å¤šæ½˜ç«‹é…®", abbr: "DOM", aliases: ["å—ä¸å•‰"], category: "å…¶ä»–", riskLevel: "âš ï¸ 12å²æ…ç”¨", riskColor: "risk-orange", harm: "å¿ƒè„çŒæ­»(QTé—´æœŸå»¶é•¿)ã€‚", consequence: "æ¬§ç¾é™åˆ¶ä½¿ç”¨ã€‚", alternatives: "ç›Šç”ŸèŒ" },
            { id: 24, name: "è¥¿å¸ƒæ›²æ˜", abbr: "Sibutramine", aliases: ["å‡è‚¥è¯"], category: "å…¶ä»–", riskLevel: "âŒ å…¨çƒç¦ç”¨", riskColor: "risk-red", harm: "å¢åŠ å¿ƒè„ç—…å’Œä¸­é£é£é™©ã€‚", consequence: "å·²æ³¨é”€ã€‚", alternatives: "è¿åŠ¨" },
            { id: 25, name: "åœ°å¡ç±³æ¾", abbr: "DXM", aliases: ["æ¿€ç´ ", "åœ°å¡"], category: "å…¶ä»–", riskLevel: "âš ï¸ æ…ç”¨", riskColor: "risk-orange", harm: "æ»¥ç”¨é€€çƒ§æ©ç›–ç—…æƒ…ï¼Œé™ä½å…ç–«åŠ›ã€‚", consequence: "å•çº¯æ„Ÿå†’ä¸åº”å¸¸è§„ä½¿ç”¨ã€‚", alternatives: "å¸ƒæ´›èŠ¬" },
            { id: 26, name: "åˆ©å·´éŸ¦æ—", abbr: "RBV", aliases: ["ç—…æ¯’å”‘", "Ribavirin"], category: "æŠ—ç—…æ¯’", riskLevel: "âš ï¸ ä¸æ¨è", riskColor: "risk-orange", harm: "è‡´ç•¸ï¼Œæº¶è¡€æ€§è´«è¡€ã€‚å¯¹æ™®é€šæ„Ÿå†’æ— æ•ˆã€‚", consequence: "ç”Ÿæ®–æ¯’æ€§å¤§ã€‚", alternatives: "å¥¥å¸ä»–éŸ¦" },
            { id: 27, name: "å¼ºæ•ˆæ¿€ç´ è†", abbr: "Steroids", aliases: ["æ°¯å€ä»–ç´¢", "ç‰¹ç¾è‚¤"], category: "å…¶ä»–", riskLevel: "âš ï¸ å„¿ç«¥æ…ç”¨", riskColor: "risk-orange", harm: "çš®è‚¤èç¼©ï¼Œæ¿€ç´ ä¾èµ–ï¼ŒæŠ‘åˆ¶ç”Ÿé•¿ã€‚", consequence: "åº”é€‰å¼±æ•ˆæ¿€ç´ ã€‚", alternatives: "å°¤å“å°”" },
            { id: 28, name: "å¤´å­¢åœ°å°¼", abbr: "Cefdinir", aliases: ["å¤´å­¢"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âœ… å®‰å…¨æŠ—ç”Ÿç´ ", riskColor: "risk-green", harm: "å¯¹ç—‡è¯ç‰©ï¼Œè¯·éµåŒ»å˜±æœç”¨ã€‚", consequence: "ä¸‰ä»£å¤´å­¢ï¼Œé’ˆå¯¹å‘¼å¸é“ã€‚", alternatives: "æ— " },
            { id: 29, name: "é˜¿å¥‡éœ‰ç´ ", abbr: "Azithromycin", aliases: ["é˜¿å¥‡"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âœ… æ”¯åŸä½“ç‰¹æ•ˆ", riskColor: "risk-green", harm: "æ³¨æ„èƒƒè‚ ååº”ï¼Œåƒ3åœ4ã€‚", consequence: "æ”¯åŸä½“é¦–é€‰ã€‚", alternatives: "æ— " },
            
            // === 30-39 è¯Šæ‰€é¿å‘è¯ ===
            { id: 30, name: "ç”²æ°§æ°¯æ™®èƒº", abbr: "Metoclopramide", aliases: ["èƒƒå¤å®‰", "æ­¢åé’ˆ"], category: "æ­¢å’³/æ­¢å", riskLevel: "âŒ å„¿ç«¥æ…ç”¨", riskColor: "risk-red", harm: "ã€é”¥ä½“å¤–ç³»ååº”ã€‘å„¿ç«¥æ˜“å‘ç”Ÿéœ‡é¢¤ã€åƒµç¡¬ã€çœ¼çƒä¸Šç¿»ï¼ˆé¬¼è„¸ç»¼åˆå¾ï¼‰ã€‚", consequence: "å„¿ç«¥åŠè€å¹´äººæ…ç”¨ã€‚", alternatives: "æ˜‚ä¸¹å¸ç¼" },
            { id: 31, name: "æ—å¯éœ‰ç´ ", abbr: "Lincomycin", aliases: ["æ´éœ‰ç´ "], category: "æŠ—ç”Ÿç´ ", riskLevel: "âš ï¸ æ·˜æ±°è¶‹åŠ¿", riskColor: "risk-orange", harm: "ã€ä¼ªè†œæ€§è‚ ç‚ã€‘ä¸¥é‡è…¹æ³»ï¼Œè¿‡æ•ååº”å¤šã€‚æ•ˆæœä¸å¦‚æ–°è¯ã€‚", consequence: "è€ä¸€ä»£æŠ—ç”Ÿç´ ï¼Œå‰¯ä½œç”¨å¤§ã€‚", alternatives: "å…‹æ—éœ‰ç´ " },
            { id: 32, name: "ç‚ç¥å®/ç©¿ç¥å®", abbr: "Andrographolide", aliases: ["æŠ—ç—…æ¯’é’ˆ"], category: "ä¸­è¯æ³¨å°„", riskLevel: "âš ï¸ é«˜å±è¿‡æ•", riskColor: "risk-orange", harm: "ã€è¿‡æ•æ€§ä¼‘å…‹ã€‘å‘ç”Ÿç‡æé«˜ï¼Œç‰¹åˆ«æ˜¯å„¿ç«¥ã€‚", consequence: "å›½å®¶è¯ç›‘å±€å¤šæ¬¡é€šæŠ¥ã€‚", alternatives: "æ— ç‰¹æ•ˆè¯ï¼Œè‡ªæ„ˆä¸ºä¸»" },
            { id: 33, name: "çº¢è¯æ°´/ç´«è¯æ°´", abbr: "Mercury/Violet", aliases: ["çº¢æ±", "é¾™èƒ†ç´«"], category: "å…¶ä»–", riskLevel: "âŒ æ·˜æ±°", riskColor: "risk-red", harm: "çº¢è¯æ°´å«æ±ï¼ˆæ°´é“¶ä¸­æ¯’ï¼‰ï¼›ç´«è¯æ°´è‡´ç™Œã€‚", consequence: "å·²è¢«ç¢˜ä¼å®Œå…¨å–ä»£ã€‚", alternatives: "ç¢˜ä¼" },
            { id: 34, name: "å¤æ–¹ç”˜è‰ç‰‡", abbr: "Licorice", aliases: ["ç”˜è‰ç‰‡"], category: "æ­¢å’³/æ­¢å", riskLevel: "âŒ æ˜“æˆç˜¾", riskColor: "risk-red", harm: "ã€é˜¿ç‰‡æˆç˜¾ã€‘å«é˜¿ç‰‡ç²‰ï¼ˆé¸¦ç‰‡ï¼‰ï¼Œé•¿æœŸåƒä¼šæˆç˜¾ã€‚", consequence: "ä¸¥æ ¼ç®¡åˆ¶è¯ç‰©ã€‚", alternatives: "å³ç¾æ²™èŠ¬" },
            { id: 35, name: "ç‰›é»„è§£æ¯’ç‰‡", abbr: "Realgar", aliases: ["è§£æ¯’ç‰‡"], category: "ä¸­è‰è¯", riskLevel: "âš ï¸ ç ·ä¸­æ¯’", riskColor: "risk-orange", harm: "å«é›„é»„ï¼ˆç ·/ç ’éœœæˆåˆ†ï¼‰ï¼Œé•¿æœŸæœç”¨ä¼¤è‚è‚¾ã€‚", consequence: "ä¸å®œé•¿æœŸæœç”¨ã€‚", alternatives: "å¤šå–æ°´" },
            { id: 36, name: "è—¿é¦™æ­£æ°”æ°´", abbr: "Alcohol Mix", aliases: ["æ­£æ°”æ°´"], category: "ä¸­è‰è¯", riskLevel: "âš ï¸ é…’ç²¾ååº”", riskColor: "risk-orange", harm: "ã€åŒç¡«ä»‘ååº”ã€‘å«é…’ç²¾ï¼è‹¥ä¸å¤´å­¢ç±»åŒåƒï¼Œå¯èƒ½è‡´æ­»ã€‚", consequence: "ä¸å¯ä¸å¤´å­¢åŒæœã€‚", alternatives: "è—¿é¦™æ­£æ°”æ¶²(æ— é†‡)" },
            { id: 37, name: "é˜¿è‹¯ç‰‡", abbr: "Compound APC", aliases: ["æ­¢ç—›ç‰‡"], category: "é€€çƒ§æ­¢ç—›", riskLevel: "âŒ ç¦ç”¨", riskColor: "risk-red", harm: "å«æ°¨åŸºæ¯”æ—+è‹¯å·´æ¯”å¦¥ï¼ŒåŒé‡æ¯’æ€§ã€‚", consequence: "å·²è¢«æ·˜æ±°ã€‚", alternatives: "å¸ƒæ´›èŠ¬" },
            { id: 38, name: "å¤´å­¢æ›²æ¾+é’™", abbr: "Interaction", aliases: ["è¾“æ¶²ååº”"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âŒ è‡´æ­»ç¦å¿Œ", riskColor: "risk-red", harm: "ã€ç»“æ™¶è‡´æ­»ã€‘å¤´å­¢æ›²æ¾ä¸å«é’™æ¶²ï¼ˆè‘¡è„ç³–é…¸é’™ï¼‰æ··åˆäº§ç”Ÿæ²‰æ·€ï¼Œè‡´æ­»ã€‚", consequence: "ä¸¥ç¦æ··åˆè¾“æ³¨ã€‚", alternatives: "åˆ†å¼€ä½¿ç”¨" },
            { id: 39, name: "å¡é©¬è¥¿å¹³", abbr: "CBZ", aliases: ["å¾—ç†å¤š"], category: "å…¶ä»–", riskLevel: "âš ï¸ åŸºå› é£é™©", riskColor: "risk-orange", harm: "ã€å‰¥è„±æ€§çš®ç‚ã€‘æ±‰æ—äººæ˜“å‘ç”Ÿä¸¥é‡çš®è‚¤åæ­»ï¼ˆSJSï¼‰ï¼Œéœ€æµ‹åŸºå› ã€‚", consequence: "ä½¿ç”¨å‰å»ºè®®åŸºå› æ£€æµ‹ã€‚", alternatives: "åŠ å·´å–·ä¸" },

            // === 40-49 æ–°å¢ï¼šéšè”½é£é™©ä¸å„¿ç«¥å®‰å…¨ ===
            { id: 40, name: "å­Ÿé²å¸ç‰¹é’ ", abbr: "Montelukast", aliases: ["é¡ºå°”å®", "å­Ÿé²"], category: "æ­¢å’³/æ­¢å", riskLevel: "âš ï¸ é»‘æ¡†è­¦å‘Š", riskColor: "risk-orange", harm: "ã€ç²¾ç¥å‰¯ä½œç”¨ã€‘FDAé»‘æ¡†è­¦å‘Šï¼šå¯èƒ½å¯¼è‡´å„¿ç«¥å™©æ¢¦ã€æ”»å‡»æ€§ã€æŠ‘éƒç”šè‡³è‡ªæ€å€¾å‘ã€‚", consequence: "å®¶é•¿éœ€å¯†åˆ‡è§‚å¯Ÿå­©å­æƒ…ç»ªå˜åŒ–ã€‚", alternatives: "æ°¯é›·ä»–å®š/è¥¿æ›¿åˆ©å—ª" },
            { id: 41, name: "æ°¯éœ‰ç´ ", abbr: "Chloramphenicol", aliases: ["çœ¼è¯æ°´"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âŒ ä¸¥é‡éª¨é«“æ¯’æ€§", riskColor: "risk-red", harm: "ã€ç°å©´ç»¼åˆå¾ã€‘éª¨é«“æŠ‘åˆ¶ï¼Œå¯¼è‡´å†ç”Ÿéšœç¢æ€§è´«è¡€ï¼ˆç™½è¡€ç—…å‰å…†ï¼‰ã€‚", consequence: "ç°å·²æå°‘ä½¿ç”¨ï¼Œå„¿ç«¥ç¦ç”¨ã€‚", alternatives: "çº¢éœ‰ç´ çœ¼è†" },
            { id: 42, name: "å°å„¿æ°¨é…šé»„é‚£æ•", abbr: "Pediatric Mix", aliases: ["æŠ¤å½¤", "å°å¿«å…‹", "ä¼˜å¡ä¸¹"], category: "å…¶ä»–", riskLevel: "âš ï¸ æ˜“è¿‡é‡ä¸­æ¯’", riskColor: "risk-orange", harm: "ã€è‚æŸä¼¤ã€‘å«å¯¹ä¹™é…°æ°¨åŸºé…šã€‚è‹¥å†åƒé€€çƒ§è¯ï¼Œä¼šåŒå€è¿‡é‡è‡´è‚è¡°ç«­ã€‚", consequence: "ä¸å»ºè®®ç”¨äº6å²ä»¥ä¸‹æ™®é€šæ„Ÿå†’ã€‚", alternatives: "å•ä¸€æˆåˆ†é€€çƒ§è¯" },
            { id: 43, name: "èµ›æ´›å”‘å•‰/æ°§ç”²å”‘å•‰", abbr: "Xylometazoline", aliases: ["é¼»ç‚æ°´", "é€šé¼»å–·é›¾"], category: "å…¶ä»–", riskLevel: "âš ï¸ æˆç˜¾", riskColor: "risk-orange", harm: "ã€è¯ç‰©æ€§é¼»ç‚ã€‘è¿ç»­ä½¿ç”¨è¶…è¿‡7å¤©ä¼šå¯¼è‡´é¼»è…”åè·³æ€§å……è¡€ï¼Œè¶Šå–·è¶Šå µã€‚", consequence: "ä¸¥æ ¼é™åˆ¶ä½¿ç”¨å¤©æ•°ã€‚", alternatives: "æµ·ç›æ°´æ´—é¼»" },
            { id: 44, name: "è¥¿å’ªæ›¿ä¸", abbr: "Cimetidine", aliases: ["ç”²æ°°å’ªèƒ", "èƒƒè¯"], category: "å…¶ä»–", riskLevel: "âš ï¸ æ¿€ç´ å‰¯ä½œç”¨", riskColor: "risk-orange", harm: "ã€æŠ—é›„æ¿€ç´ ã€‘é€è¿‡è¡€è„‘å±éšœã€‚å¯èƒ½å¯¼è‡´å°ç”·å­©ä¹³æˆ¿å‘è‚²ï¼Œè€å¹´äººç¥å¿—ä¸æ¸…ã€‚", consequence: "å·²è¢«æ³•è«æ›¿ä¸ç­‰æ›¿ä»£ã€‚", alternatives: "æ³•è«æ›¿ä¸/å¥¥ç¾æ‹‰å”‘" },
            { id: 45, name: "åŒ¹å¤šè«å¾·", abbr: "Pidotimod", aliases: ["å¢å¼ºå…ç–«åŠ›"], category: "å…¶ä»–", riskLevel: "âš ï¸ 3å²ä»¥ä¸‹ç¦ç”¨", riskColor: "risk-orange", harm: "ã€æ•ˆæœä¸æ˜ã€‘ä¸´åºŠç–—æ•ˆè¯æ®ä¸è¶³ï¼Œå´è¢«æ»¥ç”¨äºå„¿ç«¥æ„Ÿå†’ã€‚", consequence: "å›½å®¶è¯ç›‘å±€ï¼š3å²ä»¥ä¸‹ç¦ç”¨ã€‚", alternatives: "å‡è¡¡é¥®é£Ÿ" },
            { id: 46, name: "ç»´Cæ³¡è…¾ç‰‡", abbr: "Vitamin C", aliases: ["æ³¡è…¾ç‰‡"], category: "å…¶ä»–", riskLevel: "âŒ ç¦ç›´æ¥åæœ", riskColor: "risk-red", harm: "ã€çª’æ¯è‡´æ­»ã€‘å„¿ç«¥ç›´æ¥åæœä¼šäº§ç”Ÿå¤§é‡æ°”ä½“å¯¼è‡´çª’æ¯æ­»äº¡ï¼ä¸”é’ å«é‡æé«˜ã€‚", consequence: "å¿…é¡»æº¶è§£åé¥®ç”¨ã€‚", alternatives: "æ™®é€šç»´Cç‰‡" },
            { id: 47, name: "ç¡è‹¯åœ°å¹³(çŸ­æ•ˆ)", abbr: "Nifedipine", aliases: ["å¿ƒç—›å®š", "æ€¥æ•‘è¯"], category: "å…¶ä»–", riskLevel: "âŒ ç¦èˆŒä¸‹å«æœ", riskColor: "risk-red", harm: "ã€ä¸­é£é£é™©ã€‘èˆŒä¸‹å«æœé™å‹è¿‡å¿«ï¼Œä¼šå¯¼è‡´è„‘ä¾›è¡€ä¸è¶³å¼•èµ·ä¸­é£ã€‚", consequence: "é«˜è¡€å‹æ€¥ç—‡ç¦å¿Œã€‚", alternatives: "ç¼“é‡Šç‰‡(éµåŒ»å˜±)" },
            { id: 48, name: "ç”²ç¡å”‘", abbr: "Metronidazole", aliases: ["ç­æ»´çµ", "ç‰™ç—›è¯"], category: "æŠ—ç”Ÿç´ ", riskLevel: "âŒ ç¦é…’/å­•æ—©ç¦", riskColor: "risk-red", harm: "ã€åŒç¡«ä»‘ååº”ã€‘æœè¯æœŸé—´é¥®é…’å¯è‡´æ­»ï¼›æ€€å­•å‰3ä¸ªæœˆç¦ç”¨ï¼ˆè‡´ç•¸é£é™©ï¼‰ã€‚", consequence: "æœè¯å‰åä¸€å‘¨ç¦é…’ã€‚", alternatives: "ï¼ˆç‰™ç—›éœ€å°±åŒ»ï¼‰" },
            { id: 49, name: "å¼€å°è¿‡çš„çœ¼è¯æ°´", abbr: "Opened Drops", aliases: ["çœ¼è¯æ°´"], category: "å…¶ä»–", riskLevel: "âŒ 4å‘¨åä¸¢å¼ƒ", riskColor: "risk-red", harm: "ã€ç»†èŒæ„ŸæŸ“ã€‘çœ¼è¯æ°´å¼€å°4å‘¨åé˜²è…å‰‚å¤±æ•ˆï¼Œå˜æˆç»†èŒåŸ¹å…»çš¿ï¼Œæ»´å…¥å¼•å‘è§’è†œç‚ã€‚", consequence: "ç“¶èº«æœ‰æ•ˆæœŸä»…æŒ‡æœªå¼€å°ã€‚", alternatives: "ä¸€æ¬¡æ€§ç‹¬ç«‹åŒ…è£…" }
        ];

        // --- é€»è¾‘ä»£ç  ---
        let currentCategory = "å…¨éƒ¨";
        let favorites = JSON.parse(localStorage.getItem('myDrugFavs') || '[]');
        
        function init() {
            // ç”Ÿæˆæ ‡ç­¾
            const categories = ["å…¨éƒ¨", "é€€çƒ§æ­¢ç—›", "æŠ—ç”Ÿç´ ", "æ­¢å’³/æ­¢å", "ä¸­è¯æ³¨å°„", "ä¸­è‰è¯", "æŠ—ç—…æ¯’", "å…¶ä»–"];
            const tagContainer = document.getElementById('categoryTags');
            
            // æ”¶è—å¤¹æ ‡ç­¾
            const favBtn = document.createElement('div');
            favBtn.className = 'tag';
            favBtn.innerHTML = `âš ï¸ æˆ‘çš„è­¦ç¤ºå• <span id="favCount">(${favorites.length})</span>`;
            favBtn.onclick = () => {
                switchCategory('favorites', favBtn);
            };
            tagContainer.appendChild(favBtn);

            categories.forEach((cat) => {
                const btn = document.createElement('div');
                btn.className = `tag ${cat === 'å…¨éƒ¨' ? 'active' : ''}`;
                btn.innerText = cat;
                btn.onclick = () => switchCategory(cat, btn);
                tagContainer.appendChild(btn);
            });

            renderList();
        }

        function switchCategory(cat, btnElement) {
            document.querySelectorAll('.tag').forEach(t => {
                t.classList.remove('active');
                t.classList.remove('fav-active');
            });
            
            currentCategory = cat;
            if (cat === 'favorites') {
                btnElement.classList.add('fav-active');
            } else {
                btnElement.classList.add('active');
            }
            renderList();
        }

        function toggleFav(e, id) {
            e.stopPropagation();
            const index = favorites.indexOf(id);
            if (index === -1) {
                favorites.push(id);
            } else {
                favorites.splice(index, 1);
            }
            localStorage.setItem('myDrugFavs', JSON.stringify(favorites));
            document.getElementById('favCount').innerText = `(${favorites.length})`;
            
            const btn = e.target.closest('.fav-btn');
            btn.classList.toggle('active');

            if (currentCategory === 'favorites') {
                renderList();
            }
        }

        function renderList() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const container = document.getElementById('drugList');
            container.innerHTML = '';

            const filtered = drugDatabase.filter(drug => {
                const matchSearch = drug.name.toLowerCase().includes(searchTerm) || 
                                    (drug.abbr && drug.abbr.toLowerCase().includes(searchTerm)) ||
                                    (drug.aliases && drug.aliases.some(a => a.toLowerCase().includes(searchTerm)));
                
                if (currentCategory === 'favorites') {
                    return favorites.includes(drug.id) && matchSearch;
                }
                
                const matchCat = currentCategory === "å…¨éƒ¨" || drug.category === currentCategory;
                return matchSearch && matchCat;
            });

            if (filtered.length === 0) {
                if (currentCategory === 'favorites') {
                    container.innerHTML = `<div style="text-align:center; padding:60px 20px; color:#94a3b8;">
                        <div style="font-size:40px; margin-bottom:10px;">ğŸ“­</div>
                        <b>è­¦ç¤ºå•æ˜¯ç©ºçš„</b><br><small>æµè§ˆæ—¶ç‚¹å‡»å³ä¸Šè§’æ˜Ÿæ˜Ÿ â­ <br>æŠŠå®¶é‡Œçš„è¯åŠ å…¥è¿™é‡Œå¤‡æŸ¥</small>
                    </div>`;
                } else {
                    container.innerHTML = `<div style="text-align:center; padding:40px; color:#94a3b8;">æœªæ‰¾åˆ°ç›¸å…³è¯ç‰©<br><small>å°è¯•è¾“å…¥"é€€çƒ§"ã€"æ¶ˆç‚"æˆ–é€šç”¨å</small></div>`;
                }
                return;
            }

            filtered.forEach(drug => {
                const isFav = favorites.includes(drug.id);
                const div = document.createElement('div');
                div.className = `card`;
                div.onclick = (e) => {
                    if(!e.target.closest('.fav-btn')) {
                        div.classList.toggle('open');
                    }
                };
                
                const abbrHtml = drug.abbr ? `<span class="abbr-badge"><b>ç®€ç§°</b>${drug.abbr}</span>` : '';

                div.innerHTML = `
                    <div class="fav-btn ${isFav ? 'active' : ''}" onclick="toggleFav(event, ${drug.id})">
                        <svg width="24" height="24" fill="${isFav ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>
                    </div>
                    <div class="card-header">
                        <div style="flex:1">
                            <h3 class="drug-name">
                                ${drug.name} 
                                ${abbrHtml}
                            </h3>
                            <span class="risk-badge ${drug.riskColor}">${drug.riskLevel}</span>
                            <div class="alias">åˆ«å/å…³é”®è¯: ${drug.aliases ? drug.aliases.join(' / ') : '-'}</div>
                        </div>
                    </div>
                    <div class="chevron">
                        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                    <div class="detail">
                        <div class="box box-harm">
                            <span class="label" style="color:var(--danger)">âš ï¸ æ ¸å¿ƒå±å®³</span>
                            ${drug.harm}
                        </div>
                        <div class="box box-policy">
                            <span class="label">ğŸ“œ æ”¿ç­–/ä¾æ®</span>
                            ${drug.consequence}
                        </div>
                        ${!drug.riskLevel.includes('âœ…') ? `
                        <div class="box box-alt">
                            <span class="label" style="color:#166534">ğŸ›¡ï¸ å®‰å…¨æ›¿ä»£</span>
                            ${drug.alternatives}
                        </div>` : ''}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // æ¨¡æ‹Ÿæ‰«æåŠŸèƒ½
        function startScan() {
            const overlay = document.getElementById('scan-overlay');
            overlay.style.display = 'flex';
            
            setTimeout(() => {
                overlay.style.display = 'none';
                // éšæœºæŒ‘é€‰ä¸€ä¸ªé«˜å±è¯å±•ç¤º (å€¾å‘äºæ–°åŠ çš„è¯)
                const randomPool = [1, 2, 40, 42, 43, 46, 49]; 
                const randomId = randomPool[Math.floor(Math.random() * randomPool.length)];
                const drug = drugDatabase.find(d => d.id === randomId);
                
                document.getElementById('searchInput').value = drug.name;
                currentCategory = "å…¨éƒ¨";
                document.querySelectorAll('.tag').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tag')[1].classList.add('active'); 
                
                renderList();
                
                setTimeout(() => {
                    const firstCard = document.querySelector('.card');
                    if(firstCard) firstCard.classList.add('open');
                    alert(`ğŸš¨ [AIæ¼”ç¤ºæ¨¡å¼] \n\nè¯†åˆ«ç»“æœï¼š${drug.name}\næ£€æµ‹åˆ°é«˜é£é™©ï¼è¯·æŸ¥çœ‹è¯¦æƒ…ã€‚`);
                }, 100);
            }, 2000);
        }

        init();
    </script>
</body>
</html>

